/* ── Agent Room layout ──────────────────────────────────────────── */
.room-body-wrap {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  overflow: hidden;
}

.room-main {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-4);
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  min-height: 0;
}
.room-main::-webkit-scrollbar { width: 4px; }
.room-main::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 2px; }

.room-footer {
  flex-shrink: 0;
  border-top: 1px solid var(--border);
  padding: var(--space-3) var(--space-4);
  position: relative;
}
.room-input-wrap { position: relative; }
#room-input {
  width: 100%;
  min-height: 52px;
  max-height: 120px;
  padding: 9px 52px 9px 12px;
  font-size: var(--font-footnote);
  font-family: var(--font);
  border: 1px solid var(--border);
  border-radius: var(--radius-md);
  background: var(--bg);
  color: var(--text);
  resize: none;
  line-height: 1.5;
}
#room-input:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
#room-input::placeholder { color: var(--text-muted); }
#room-send,
#room-abort {
  position: absolute;
  top: 50%; right: 10px; transform: translateY(-50%);
  width: 32px; height: 32px;
  border-radius: 50%;
  border: none;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: background var(--duration-micro) var(--ease-spring), transform var(--duration-micro) var(--ease-spring);
}
#room-send { background: var(--accent); color: #fff; }
#room-send:hover   { background: var(--accent-hover); }
#room-send:active  { transform: translateY(-50%) scale(0.9); }
#room-send:disabled { opacity: 0.35; cursor: not-allowed; transform: translateY(-50%); }
#room-abort { background: var(--surface-raised); color: var(--text-secondary); }
#room-abort:hover  { background: var(--danger); color: #fff; }
#room-send:focus-visible,
#room-abort:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

/* ── Agent toggles ──────────────────────────────────────────────── */
.agent-toggles {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex: 1;
  margin: 0 var(--space-4);
}
.agent-toggle {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 3px 10px 3px 7px;
  height: 26px;
  border: 1px solid var(--border);
  border-radius: 20px;
  font-size: var(--font-caption);
  font-family: var(--font);
  font-weight: 500;
  cursor: pointer;
  background: var(--surface);
  color: var(--text-secondary);
  transition: background var(--duration-micro), border-color var(--duration-micro), color var(--duration-micro);
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}
.agent-toggle:hover { background: var(--surface-raised); color: var(--text); border-color: var(--border-strong); }
.agent-toggle.active {
  background: var(--agent-bg, rgba(200,78,0,.12));
  border-color: var(--agent-color, var(--accent));
  color: var(--agent-color, var(--accent));
}
.agent-toggle.needs-auth { opacity: 0.5; }
.agent-toggle:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
.agent-dot {
  width: 7px; height: 7px;
  border-radius: 50%;
  background: var(--border-strong);
  flex-shrink: 0;
}
.agent-toggle.active .agent-dot { background: var(--agent-color, var(--accent)); }

/* ── Auth header section ────────────────────────────────────────── */
.header-auth { display: flex; align-items: center; gap: var(--space-2); flex-shrink: 0; }
.gh-login-btn {
  display: inline-flex; align-items: center; gap: 5px;
  padding: 4px 10px;
  height: 26px;
  font-size: var(--font-caption); font-weight: 600; font-family: var(--font);
  background: #24292f; color: #fff;
  border: none; border-radius: var(--radius); cursor: pointer;
  transition: background var(--duration-micro);
  flex-shrink: 0;
}
.gh-login-btn:hover { background: #1a1f24; }
.gh-login-btn svg { flex-shrink: 0; }
.auth-user-pill {
  display: inline-flex; align-items: center; gap: var(--space-2);
  padding: 2px 8px 2px 2px;
  height: 26px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  font-size: var(--font-caption);
  color: var(--text-secondary);
}
.auth-user-pill img {
  width: 20px; height: 20px;
  border-radius: 50%;
  object-fit: cover;
}
.auth-logout-btn {
  background: none; border: none; cursor: pointer;
  color: var(--text-muted); font-size: var(--font-caption);
  padding: 0 0 0 4px;
  font-family: var(--font);
}
.auth-logout-btn:hover { color: var(--danger); }

/* ── Messages ───────────────────────────────────────────────────── */
.room-msg {
  display: flex;
  max-width: 78%;
  animation: fadeInUp var(--duration-base) var(--ease-spring) both;
}
.room-msg-user { align-self: flex-end; justify-content: flex-end; }
.room-msg-agent { align-self: flex-start; gap: var(--space-2); }

.room-bubble {
  font-size: var(--font-footnote);
  line-height: 1.55;
  word-break: break-word;
  white-space: pre-wrap;
}
.room-msg-user .room-bubble {
  background: var(--accent-light);
  border: 1px solid var(--accent-border);
  border-radius: var(--radius-md) var(--radius-md) var(--space-1) var(--radius-md);
  padding: var(--space-2) var(--space-3);
  color: var(--text);
}
.agent-bubble {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--space-1) var(--radius-md) var(--radius-md) var(--radius-md);
  padding: var(--space-2) var(--space-3);
  color: var(--text);
}
.agent-bubble.error { border-color: var(--danger); color: var(--danger); }

.agent-body { display: flex; flex-direction: column; gap: 3px; min-width: 0; }
.agent-name {
  font-size: var(--font-caption);
  font-weight: 600;
  letter-spacing: 0.02em;
  padding-left: 2px;
}

/* ── Agent avatar ───────────────────────────────────────────────── */
.agent-avatar {
  width: 28px; height: 28px;
  border-radius: 50%;
  background: var(--agent-bg, rgba(200,78,0,.15));
  color: var(--agent-color, var(--accent));
  font-size: var(--font-caption);
  font-weight: 700;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  margin-top: 18px; /* align with bubble, under the name */
  text-transform: uppercase;
  border: 1px solid var(--agent-color, var(--accent));
  opacity: 0.85;
}

/* ── Inline spinner (thinking) ──────────────────────────────────── */
.room-spinner { display: inline-flex; gap: 3px; align-items: center; padding: 2px 0; }
.room-spinner span {
  width: 5px; height: 5px;
  border-radius: 50%;
  background: var(--text-muted);
  animation: chat-bounce 1.2s ease-in-out infinite;
}
.room-spinner span:nth-child(2) { animation-delay: 0.2s; }
.room-spinner span:nth-child(3) { animation-delay: 0.4s; }

/* ── Empty state ────────────────────────────────────────────────── */
.room-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  flex: 1;
  gap: var(--space-3);
  color: var(--text-muted);
  font-size: var(--font-footnote);
  text-align: center;
  padding: var(--space-8);
}
.room-empty-title {
  font-size: var(--font-subhead);
  font-weight: 600;
  color: var(--text-secondary);
}
.room-empty-hint { font-size: var(--font-caption); }
